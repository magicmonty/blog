extends layout

block content
  include comments
  include author
  include categories
  include date

  h1.category
    | Category: #{page.metadata.meta.category}
  //- underscore helps us filter and sort our articles
  - var articles = _.chain(contents.articles._.directories).map(function(item) {
  -   // map articles to index pages of subdirectories of 'articles'
  -   return item.index
  - }).compact().sortBy(function(item) { // compact removes any directories w/o an index
  -   // sort them by date
  -   return -item.date
  - }).value() // and finally take the first 5
  each article in articles
    - var category = article.metadata.category;
    if category
      found = false;
      each c in category.split(",")
        if c == page.metadata.meta.category
          article.index(itemscope="itemscope", itemtype="http://schema.org/BlogPosting")
            header
              h1(itemprop="name")
                a(href=article.url, rel="bookmark", title="Permanent Link: " + article.title)= article.title
              div.post-meta.hidden-phone
                +comments(article.url)
                div.date
                  span 
                    +datestring(article.metadata.date)
                div.info
                  | von 
                  +author(article.metadata.author)
                  if article.metadata.category
                    |  in 
                    +categories(article.metadata.category)
            div.content(itemprop="description articleBody")!= article.intro
            if article.hasMore
              p.read-more
                    a(href=article.url) read more

block append scripts
  script(type="text/javascript")
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'pagansoft'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
